<div class="modal fade" id="columnManagement" tabindex="-1" role="dialog" aria-labelledby="columnManagementLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="columnManagementLabel">Manage columns</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form id='columnsForm'>
          <div class="modal-body">
              <p>Select columns to display. Reorder columns by dragging.</p>
              <ul id="columnsList" class="list-group">
                {% for column, state in columns %}
                  <li class="list-group-item {% if not state %}list-group-item-secondary{% endif %}" draggable="True" data-column="{{ column }}">
                    <input type="checkbox" id="{{ column }}Check" {% if state %}checked{% endif %} />
                    <label class="form-check-label" for="{{ column }}Check">{{ column }}</label>
                  </li>
                {% endfor %}
              </ul>
          </div>
          <div class="modal-footer">
            <button id="saveColumns" type="button" class="btn btn-primary">Save changes</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          </div>
      </form>
    </div>
  </div>
</div>

<script>
$(document).ready(function() {
  // Changing state of list items when (de)selected
  $("#columnsForm .list-group-item>input").click(function() {
    // $(this).parent().toggleClass('disabled');
    $(this).parent().toggleClass('list-group-item-secondary');
  });

  // Allow for reordering columns through drag-and-drop using jQuery UI
  $("#columnsList").sortable();

  // Save column settings
  $("#saveColumns").click(function() {
    $(this).addClass('disabled');
    $(this).text("Saving...")
    // TODO: get new ordering through $("#columnsList li").data('column') and .attr('checked')
    // TODO: $.ajax(...)
    // TODO: close modal
    // TODO: use toggleColumn() to update display
  });
});
</script>
